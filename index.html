<!DOCTYPE html>
<html>
  <head>
    <title>我的简历</title>
    <link rel="stylesheet" href="./main.css">
    <link rel="stylesheet" href="./loading.css">
    <script src="//at.alicdn.com/t/font_978439_m95qkm7mswa.js"></script>
    <style type="text/css">
      .icon {
         width: 1em; height: 1em;
         vertical-align: -0.15em;
         fill: currentColor;
         overflow: hidden;
      }
      .site-welcome{
        display: none;
        position: fixed;
        top: 0;left: 0;width: 100%;height: 100%;
        background: #888;
        z-index: 1;
        /*z-index为1将site-welcome这个div置于所有div的顶层*/
        justify-content: center;
        align-items: center;
      }
      .site-welcome.active{
        display: flex;
      }
      /*若是display:block，则loading图像无法居中*/
    </style>
  </head>
  <body>
    <hr />
    <div id="siteWelcome" class="site-welcome active">
        <div class="loading"></div>
    </div>
    <div id="topNavBar" class="topNavBar">
      <div class="topnav-in clearfix">
        <a class="logo" href="#" alt="logo">
          <span class="rs">RS</span><span class="card">card</span>
        </a>
        <nav class="menu">
          <ul class="clearfix">
            <li>
              <a href="#siteAbout">ABOUT</a>
            </li>
            <li>
              <a href="#siteSkills">SKILLS</a>
              <ul class="submenu">
                  <li>技能1</li>
                  <li>技能2</li>
                  <li>技能3</li>
              </ul>
            </li>
            <li><a href="#">EXPERIENCE</a></li>
            <li><a href="#">PRICING</a></li>
            <li>
              <a href="#siteWorks">Works</a>
              <ul class="submenu">
                  <li>作品1</li>
                  <li>作品2</li>
                  <li>作品3</li>
              </ul>
              <!--快速写法：ul>li{作品$}*3-->
              <!--ul尽量加在a的外面S-->
            </li>
            <li><a href="#">CALENDAR</a></li>
            <li><a href="#">CONTACT</a></li>
            <li><a href="#">OTHER</a></li>
            <li><a href="#">ALL DEMOS</a></li>
          </ul>
        </nav>
      </div>
    </div>
    <div class="banner">
      <div class="mask"></div>
    </div>
    <main style="margin-top: -340px;">
      <div data-x id="siteAbout" class="userCard">
        <div class="pictureAndText clearfix">
          <div class="picture">
            <img src="./photo.jpg" width=299 height=347 alt="头像">
          </div>
          <div class="text">
            <span class="welcome">Hello
              <span class="triangle"></span>
            </span>
            <h1>罗旷</h1>
	          <p>王者</p>
	          <hr>
	          <dl>
	            <dt>年龄</dt>
	            <dd>22</dd>
	            <dt>学历</dt>
	            <dd>bluefly</dd>
            </dl>
          </div>
        </div>
	      <footer class="media">
          <a href="#">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-weibo"></use>
            </svg>
          </a>
          <a href="#">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-tuite"></use>
            </svg>
          </a>
          <a href="#">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-jirengulogoyellow"></use>
            </svg>
          </a>
          <a href="#">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-zhihu"></use>
            </svg>
          </a>
          <a href="#">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-github"></use>
            </svg>
          </a>
	      </footer>
      </div>
      <p class="downloadResume-wrapper" style="text-align:center;">
        <a class="downloadResume" href="./resume.pdf" target="_blank" download>下载PDF简历</a>
      </p>
      <p class="self-introduction">
        我是一个王者
        <br>啦啦啦德玛西亚
      </p>
    </main>
    <section data-x id="siteSkills" class="skills">
      <h2>技能</h2>
      <ol class="clearfix">
        <li>
          <!-- <div style="margin-right: 10px;"> -->
            <h3>
              HTML 5 &amp; CSS 3
            </h3>
            <div class="processBar">
              <div class="process"></div>
            </div>
          <!-- </div> -->
        </li>
        <li>
        <!--我们在css里统一定义进度都是70%，若是每个skills的进度不一样，我们可以在不一样的li的标签上单独写width，会覆盖css里面的width*/-->
          <h3>
            JavaScript
          </h3>
          <div class="processBar">
            <div class="process"></div>
          </div>
        </li>
        <li>
          <h3>
            jQuery
          </h3>
          <div class="processBar">
            <div class="process"></div>
          </div>
        </li>
        <li>
          <h3>
            Vue
          </h3>
          <div class="processBar">
            <div class="process"></div>
          </div>
        </li>
        <li>
          <h3>
            React
          </h3>
          <div class="processBar">
            <div class="process"></div>
          </div>
        </li>
        <li>
          <h3>
            HTTP
          </h3>
          <div class="processBar">
            <div class="process"></div>
          </div>
        </li>
      </ol>
    </section>
    <section data-x id="siteWorks" class="portfolio">
      <h2>作品集</h2>
      <nav>
        <ol class="clearfix">
          <li id="portfolio1">所有</li>
          <li id="portfolio2">框架</li>
          <li id="portfolio3">原生JS&amp;CSS</li>
        </ol>
        <div id="portfolioBar" class="bar state-1">
          <div class="bar-in"></div>
        </div>
      </nav>
      <script>
        portfolio1.onclick=function(){
          portfolioBar.className="bar state-1"
        }
        portfolio2.onclick=function(){
          portfolioBar.className="bar state-2"
        }
        portfolio3.onclick=function(){
          portfolioBar.className="bar state-3"
        }
      </script>
      <div class="works" style="height:597px">
        <div class="big" style="top:0;left:0;">
          <img src="./1.jpg" alt="作品1">
        </div>
        <!--0也要写上，否则会出bug-->
        <div class="small" style="top:0;left:645px;">
            <img src="./2.jpg" alt="作品2">
        </div>
        <div class="small" style="top:312px;left:645px;">
            <img src="./3.jpg" alt="作品3">
        </div>
      </div>

    </section>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.1.1/Tween.min.js"></script>
    <script>
      setTimeout(function(){
        siteWelcome.classList.remove('active')
      },500)
      //这个JS写在最后面，是为了让上面所有的div加载完成之后，解除loading状态，进入正常页面，可惜由于网速太快，loading始终没出现
      //setTimeout用于在一段时间后执行这段代码

let specialTags=document.querySelectorAll('[data-x]')
for(let i=0;i<specialTags.length;i++){
  specialTags[i].classList.add('offset')
}
//offset类是为了让页面滚动到某元素时，有跳动效果
setTimeout(function(){
  findClosest()
},1500)
//这个setTimeOut是为了在还未滚动页面时（相当于第一个元素），自动取消offset类
window.onscroll=function(xxxx){
  //onscroll监控页面滚动
  if(window.scrollY>0){
    topNavBar.classList.add('sticky')
  }else{
    topNavBar.classList.remove('sticky')
  }
  //sticky是为了让导航栏向下滚动时，背景变白等一系列操作
  findClosest()
}
function findClosest(){
  let specialTags=document.querySelectorAll('[data-x]')
  //注意specialTags是一个数组，每个标签是数组中的元素
  let minIndex=0
  for(let i=1;i<specialTags.length;i++){
    if(Math.abs(specialTags[i].offsetTop-window.scrollY)<Math.abs(specialTags[minIndex].offsetTop-window.scrollY)){
      minIndex=i
    }
  }
  specialTags[minIndex].classList.remove('offset')
  let id=specialTags[minIndex].id
  let a=document.querySelector('a[href="#'+id+'"]')
  //注意这一句，与前面a标签的格式对应
  //id=='siteAbout'        'a[href="#siteAbout"]'
  let li=a.parentNode
  let brotherAndMe=li.parentNode.children
  for(let i=0;i<brotherAndMe.length;i++){
    brotherAndMe[i].classList.remove('highlight')
  }
  li.classList.add('highlight')
}

//JS只做改变状态（改变classList）的事
//let liTags=document.getElementsByClassName('menuTigger')
let liTags=document.querySelectorAll('nav.menu>ul>li')
//querySelectorAll返回选择器的所有元素
for(let i=0;i<liTags.length;i++){
  liTags[i].onmouseenter=function(x){
    //onmouseenter表示鼠标进入某一元素，执行以下代码；onmouseleave表示鼠标离开某一元素，执行以下代码
    //let li=x.currentTarget
    //在onmouseenter中，此时的x.target和x.currentTarget都表示a标签，无差别
    //但是，若a标签中还有span元素，span元素包裹着SKILLS，则x.target表示span元素，x.currentTarget表示a标签
    //因此，为保险起见，采用x.currentTarget
    //let bro=a.nextSibling
    //while(bro.nodeType===3&&bro.tagName!=='UL'){
    //  bro=bro.nextSibling
    //}
    //理论上来说，a.nextSibling表示a的弟弟元素，但是一般浏览器提供的API不可靠，这里a.nextSibling表示的是一个回车，
    //a.nextSibling.nextSibling表示的才是弟弟元素，在这里，为保险起见，用了一个while语句
    //bro.nodeType===3表示a的弟弟元素是文本弟弟（Node.TEXT_NODE），等于1表示是节点弟弟
    //&&前后的两个条件择一即可
    //文本节点没有tagName
    //toLowerCase()表示大写变小写
    //let bro=li.getElementsByTagName('ul')[0]
    //bro.classList.add('active')
    x.currentTarget.classList.add('active')
  }
  liTags[i].onmouseleave=function(x){
    //let li=x.currentTarget
    //let bro=li.getElementsByTagName('ul')[0]
    //bro.classList.remove('active')
    //上面这三句仅使ul变成active，但是还存在问题，即鼠标放在导航条上，下面出现红条，是hover控制；鼠标放在ul上是active，不出现红条，所以整个menuTigger都用active控制
    x.currentTarget.classList.remove('active')
  }
}
//点击导航栏页面跳转到相应位置，但是悬浮的导航栏会遮蔽部分内容，可用在相应标签上加上下padding来实现
//但一个一个加太麻烦，因此可用下面几行代码，选取相应标签，使标签上部距整个页面最上方的位置再减去一些距离（top-80）
let aTags=document.querySelectorAll('nav.menu>ul>li>a')
for(let i=0;i<aTags.length;i++){
  aTags[i].onclick=function(x){
    x.preventDefault()
    let a=x.currentTarget
    let href=a.getAttribute('href')
    let element=document.querySelector(href)
    let top=element.offsetTop

    let currentTop = window.scrollY   //?
    let targetTop = top - 80
    let s = targetTop - currentTop
    //let n=25
    //let t=500/n
    //let s=S/n
    //let i=0
    //  let id=setInterval(()=>{   //setTimeout 只能动一次，setInterval 能连续的动
    //  if(i===n){
    //    window.clearInterval(id)
    //    return
    //  }
    //  i=i+1
    //  window.scrollTo(0,currentTop+s*i)
    //},t)
    function animate(time) {
      requestAnimationFrame(animate);
      TWEEN.update(time);
    }
    requestAnimationFrame(animate);
    //上面这个function不知道具体作用，不用管

    var coords = { y: currentTop}; // 起始位置
    var t=Math.abs((s/100)*300)  //t根据滚动的距离可变动
    if(t>500){t=500}  //若时间过长，则设为500ms
    var tween = new TWEEN.Tween(coords) // 起始位置
      .to({ y: targetTop}, t) // 结束位置 和 时间
      .easing(TWEEN.Easing.Quadratic.InOut) // 缓动类型
      .onUpdate(function() {
        // coords.y 已经变了
        window.scrollTo(0,coords.y) // 如何更新界面
      })
      .start(); // 开始缓动
  }
}

    </script>
  </body>
</html>
